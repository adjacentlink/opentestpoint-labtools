FROM centos:centos7

RUN mkdir -p /opt/built

RUN yum -y install epel-release
RUN yum -y update

# Copy and install packages from the latest opentestpoint build
WORKDIR /opt
# RUN mkdir -p dependencies
# RUN yum -y install dependencies/*\.rpm

# Build tools
RUN yum -y install git make autoconf automake libtool rpm-build python-setuptools \
                   python-devel

RUN git clone https://github.com/adjacentlink/opentestpoint-labtools -b develop
WORKDIR opentestpoint-labtools
RUN ./autogen.sh
RUN ./configure --with-python2
RUN make rpm
RUN cp $(find .rpmbuild/RPMS -name "*\.rpm") /opt/built
RUN yum -y install /opt/built/*

RUN yum clean all

RUN echo 'complete'

